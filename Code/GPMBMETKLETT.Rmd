Load datasets
```{r}
individuals <- individuals_data
individuals <- read.csv("./CSV Data Sheets/individuals_data.csv", header = TRUE)
individuals$diet <- as.factor(individuals$diet)
individuals$diet = factor(individuals$diet,c("FSHSQ","FSH","FSQ","SHSQ","F","SH","SQ","PELL"))

dryfishweights <- read.csv(file = "./CSV Data Sheets/dryfishweights_data.csv", header = TRUE)

allfish <- allfish_data
allfish <- read.csv(file = "./CSV Data Sheets/allfish_data.csv", header = TRUE)
allfish$diet = factor(allfish$diet,c("FSHSQ","FSH","FSQ","SHSQ","F","SH","SQ","PELL"))

justinwt <- justinwt_data
justinwt <- read.csv("./CSV Data Sheets/justinwt_data.csv", header = TRUE)
justinwt$diet = factor(justinwt$diet,c("FSHSQ","FSH","FSQ","SHSQ","F","SH","SQ","PELL"))

metabolomics <- metabolomics_data
metabolomics <- read.csv(file = "./CSV Data Sheets/metabolomics_data.csv", header = TRUE)

proximates <- proximates_data
proximates <- read.csv(file = "./CSV Data Sheets/proximates_data.csv", header = TRUE)

```


Plot Data
```{r}
plot(individuals$wt ~ individuals$tlmm, xlab = "Individual Total Length (mm)", ylab = "Individual Weight (g)", main = "Individual Weight vs Length Relationship", pch = 16, las = 1)
lm01 <- lm(individuals$wt ~ individuals$tlmm)
abline(lm01, col = "blue")
summary(lm01)
# Exponential Model
theta.0 <- min(individuals$wt) * 0.5
model.0 <- lm(log(individuals$wt - theta.0) ~ individuals$wt, data = individuals)  
alpha.0 <- exp(coef(model.0)[1])
beta.0 <- coef(model.0)[2]
start <- list(alpha = alpha.0, beta = beta.0, theta = theta.0)
start
expmod <- nls(individuals$wt ~ alpha * exp(beta*individuals$tlmm) + theta, data = individuals, start = start)
summary(expmod)
plot(individuals$wt ~ individuals$tlmm)
lines(individuals$tlmm, predict(expmod, list(individuals$tlmm)), col = 'blue', lwd = 1)
AIC(lm01)
AIC(expmod)


plot(individuals$tlmm, individuals$liverwt, xlab = "Individual Total Length (mm)", ylab = "Individual Liver Weight (g)", main = "Individual Total Length vs Liver Weight HSI", pch = 16, las = 1)
lm02 <- lm(individuals$liverwt ~ individuals$tlmm)
abline(lm02, col = "blue")
summary(lm02)
#taking out diet 8 makes model much better; shows difference in pellets w/natural diets
df2 <- data.frame(individuals$diet[individuals$diet != 8], individuals$tlmm[individuals$diet != 8], individuals$liverwt[individuals$diet != 8])
df2
plot(df2$individuals.tlmm.individuals.diet....8.,df2$individuals.liverwt.individuals.diet....8.)
lmdf2 <- lm(df2$individuals.liverwt.individuals.diet....8. ~ df2$individuals.tlmm.individuals.diet....8.)
abline(lmdf2, col = "blue")
summary(lmdf2)

plot(individuals$wt, individuals$liverwt, xlab = "Individual Weight (g)", ylab = "Individual Liver Weight (g)", main = "Individual Weight vs Liver Weight Relationship", pch = 16, las = 1)
lm03 <- lm(individuals$liverwt ~ individuals$wt)
abline(lm03, col = "blue")
summary(lm03)
#taking out diet 8 makes model much better; shows difference in pellets w/natural diets
df3 <- data.frame(individuals$diet[individuals$diet != 8], individuals$wt[individuals$diet != 8], individuals$liverwt[individuals$diet != 8])
df3
plot(df3$individuals.wt.individuals.diet....8.,df3$individuals.liverwt.individuals.diet....8.)
lmdf3 <- lm(df$individuals.liverwt.individuals.diet....8. ~ df$individuals.wt.individuals.diet....8.)
abline(lmdf3, col = "blue")
summary(lmdf3)


boxplot(justinwt$weight ~ justinwt$diet, xlab = "Diet", ylab = "Average Fish Weight (g)", main = "Average Fish Weight Across Diets", ylim = c(0,200), par(cex.axis=0.70))

boxplot(individuals$wt ~ individuals$diet, xlab = "Diet", ylab = "Fish Weight (g)", main = "Average Fish Weight Across Diets", ylim = c(0,200), las = 1, par(cex.axis=0.70))

boxplot(individuals$liverwt ~ individuals$diet, xlab = "Diet", ylab = "Liver Weight (g)", main = "Average Fish Liver Weight Across Diets", las = 1, par(cex.axis=0.70))

boxplot(individuals$percentviscera ~ individuals$diet, xlab = "Diet", ylab = "Percent Viscera (%)", main = "Average Fish Percent Viscera Across Diets", ylim = c(0,16), las = 1, par(cex.axis=0.70))

boxplot(individuals$tlmm ~ individuals$diet, xlab = "Diet", ylab = "Total Length (mm)", main = "Average Fish Total Length Across Diets", las = 1, par(cex.axis=0.70))

boxplot(individuals$evisceratedwt ~ individuals$diet, xlab = "Diet", ylab = "Eviscerated Weight (g)", main = "Average Fish Eviscerated Weights Across Diets", las = 1, par(cex.axis=0.70))

boxplot(individuals$conditionfactor ~ individuals$diet, xlab = "Diet", ylab = "Condition Factor (g/cm^3)", main = "Average Fish Condition Factor Across Diets", las = 1, par(cex.axis=0.70))

boxplot(individuals$hsi ~ individuals$diet, xlab = "Diet", ylab = "HSI (g/mm)*100", main = "Average Fish Heposomatic Index Across Diets", las = 1, par(cex.axis=0.70))

boxplot(individuals$wtdiff ~ individuals$diet, xlab = "Diet", ylab = "Weight Difference (g)", main = "Average Fish Total Weight - Eviscerated Weight", ylim = c(0,20), las = 1, par(cex.axis=0.70))


boxplot(allfish$wt ~ allfish$diet, xlab = "Diet", ylab = "Average Fish Weight (g)", main = "Average Fish Weight Across Diets", ylim = c(0,250), las = 1, par(cex.axis=0.70))

boxplot(allfish$tlmm ~ allfish$diet, xlab = "Diet", ylab = "Average Total Length (mm)", main = "Average Fish Total Length Across Diets", ylim = c(0,300), las = 1, par(cex.axis=0.70))

```



Mean weights compated between justin, sampling, and sampling and drying to see if there are any huge discrepancies.
```{r}
#mean average fish weight my sampling only
mean(justinwt$weight[justinwt$diet == "FSHSQ"])
mean(justinwt$weight[justinwt$diet == "FSH"])
mean(justinwt$weight[justinwt$diet == "FSQ"])
mean(justinwt$weight[justinwt$diet == "SHSQ"])
mean(justinwt$weight[justinwt$diet == "F"])
mean(justinwt$weight[justinwt$diet == "SH"])
mean(justinwt$weight[justinwt$diet == "SQ"])
mean(justinwt$weight[justinwt$diet == "PELL"])

#mean average fish weight my sampling only
mean(individuals$wt[individuals$diet == "FSHSQ"])
mean(individuals$wt[individuals$diet == "FSH"])
mean(individuals$wt[individuals$diet == "FSQ"])
mean(individuals$wt[individuals$diet == "SHSQ"])
mean(individuals$wt[individuals$diet == "F"])
mean(individuals$wt[individuals$diet == "SH"])
mean(individuals$wt[individuals$diet == "SQ"])
mean(individuals$wt[individuals$diet == "PELL"])

#mean average fish weight my sampling and drying
mean(allfish$wt[allfish$diet == "FSHSQ"])
mean(allfish$wt[allfish$diet == "FSH"])
mean(allfish$wt[allfish$diet == "FSQ"])
mean(allfish$wt[allfish$diet == "SHSQ"])
mean(allfish$wt[allfish$diet == "F"])
mean(allfish$wt[allfish$diet == "SH"])
mean(allfish$wt[allfish$diet == "SQ"])
mean(allfish$wt[allfish$diet == "PELL"])

```


Anova's
Anova's for: Across treatments

All factors for diets (Growth Rate, SGR, Average weight, Average TL, FCR, Liver weight, Eviscerated weight, condition factor, weight diff, % viscera, HSI)
All factors for Fish weights (% H20, Dry Matter, Body Weight)
Justin sampling average weight and individual weights from my sampling for whole fish and muscle for each diet

```{r}
library(car)

anovagrowthrate <- Anova(diets$growthrategpday ~ diets$diet)
anovasgr <- Anova(diets$sgr ~ diets$diet)
anovaavewt <- Anova(diets$avewt ~ diets$diet)
anovafcr <- Anova(diets$fcr ~ diets$diet)
anovaliverwt <- Anova(diets$liverwt ~ diets$diet)
anovaevisceratedwt <- Anova(diets$evisceratedwt ~ diets$diet)
anovacf <- Anova(diets$cfgperday ~ diets$diet)
anovawtdiff <- Anova(diets$wtdiffgrams ~ diets$diet)
anovapercentviscera <- Anova(diets$percentviscera ~ diets$diet)
anovahsi <- Anova(diets$hsi ~ diets$diet)

#individuals

#hsi linear model
lmhsi <- lm(individuals$hsi ~ individuals$diet, data = individuals)
summary(lmhsi)
aovhsi <- aov(individuals$hsi ~ individuals$diet, data = individuals)
summary(aovhsi)
aovhsi
posthoc1 <- TukeyHSD(x=aovhsi, 'individuals$diet', conf.level=0.99)
posthoc1

#liverwt linear model
lmliverwt <- lm(individuals$liverwt ~ individuals$diet)
summary(lmliverwt)
aovliverwt <- aov(individuals$liverwt ~ individuals$diet)
aovliverwt
summary(aovliverwt)
posthoc2 <- TukeyHSD(x=aovliverwt, 'individuals$diet', conf.level=0.99)
posthoc2

#wt linear model
lmwt <- lm(individuals$wt ~ individuals$diet)
summary(lmwt)
aovwt <- aov(individuals$wt ~ individuals$diet)
aovwt
summary(aovwt)
posthoc3 <- TukeyHSD(x=aovwt, 'individuals$diet', conf.level=0.99)
posthoc3

#tlmm linear model
lmtlmm <- lm(individuals$tlmm ~ individuals$diet)
summary(lmtlmm)
aovtlmm <- aov(individuals$tlmm ~ individuals$diet)
aovtlmm
summary(aovtlmm)
posthoc4 <- TukeyHSD(x=aovtlmm, 'individuals$diet', conf.level=0.99)
posthoc4

#%viscera linear model
lmviscera <- lm(individuals$percentviscera ~ individuals$diet)
summary(lmviscera)
aovviscera <- aov(individuals$percentviscera ~ individuals$diet)
aovviscera
summary(aovviscera)
posthoc5 <- TukeyHSD(x=aovviscera, 'individuals$diet', conf.level=0.99)
posthoc5

#condition factor linear model
lmcf <- lm(individuals$conditionfactor ~ individuals$diet)
summary(lmcf)
aovcf <- aov(individuals$conditionfactor ~ individuals$diet)
aovcf
summary(aovcf)
posthoc6 <- TukeyHSD(x=aovcf, 'individuals$diet', conf.level=0.99)
posthoc6
```


PCA Coding for Metabolomics Analysis
RDA indirect ordination and then do a direct ordination
```{r}

```


ANOVA's for Proximate Analysis and bar plots of proximates
```{r}
protein <- table(proximates$protein)
barplot(protein, main="Protein comparison among diet treatments", 
   xlab="Diets")

fat <- table(proximates$fat)
barplot(fat, main="Fat comparison among diet treatments", 
   xlab="Diets")

carb <- table(proximates$carb)
barplot(carb, main="Carbohydrate comparison among diet treatments", 
   xlab="Diets")


```

















